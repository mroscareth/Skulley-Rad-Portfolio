const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-BWB_NsdB.js","assets/vendor-3d-CqXBc1-r.js","assets/vendor-postfx-DOJ-Wo09.js","assets/Section1-C4DYUQFF.js","assets/Section2-BM9kXko-.js","assets/Section3-DyCAKFMm.js","assets/Section4-B_YpNlz0.js"])))=>i.map(i=>d[i]);
import{r as t,a as e,h as ze,k as Mt,F as zt,l as Ut,n as Wt,o as $t,q as Yt,t as qt}from"./vendor-BWB_NsdB.js";import{a9 as Je,r as ee,aa as Gt,ab as Xt,ac as xt,ad as Ct,V as T,ae as Rt,af as ut,ag as Ae,$ as Be,ah as kt,ai as se,aj as Tt,ak as Vt,al as Ht,am as Kt,an as Zt,ao as Jt,ap as Et,aq as Ft,ar as Nt,as as Pt,at as At,au as Qt,av as en,aw as tn,ax as nn,ay as on,az as an,aA as rn,aB as sn,aC as Ge,aD as cn,x as ln,aE as un,aF as dn,aG as fn}from"./vendor-3d-CqXBc1-r.js";import{h as te,g as It,i as mn}from"./vendor-postfx-DOJ-Wo09.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))f(u);new MutationObserver(u=>{for(const m of u)if(m.type==="childList")for(const l of m.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&f(l)}).observe(document,{childList:!0,subtree:!0});function r(u){const m={};return u.integrity&&(m.integrity=u.integrity),u.referrerPolicy&&(m.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?m.credentials="include":u.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function f(u){if(u.ep)return;u.ep=!0;const m=r(u);fetch(u.href,m)}})();function pn({overrideColor:a,lowPerf:n=!1}){const r=a||"#204580",{scene:f}=Je(),u=t.useRef();return t.useEffect(()=>{f&&(f.background=new ee(r))},[f,r]),t.useEffect(()=>{const m=u.current;m&&(m.onBeforeCompile=l=>{try{const w="gl_FragColor = vec4( outgoingLight, diffuseColor.a );",M=`
          vec3 _out = outgoingLight;
          float _lum = dot(_out, vec3(0.2126, 0.7152, 0.0722));
          // Clamp only very hot highlights
          float _k = smoothstep(0.92, 1.2, _lum);
          vec3 _tgt = _out * (0.85 / max(_lum, 1e-3));
          _out = mix(_out, _tgt, _k);
          gl_FragColor = vec4(_out, diffuseColor.a );
        `;l.fragmentShader.includes(w)&&(l.fragmentShader=l.fragmentShader.replace(w,M))}catch{}},m.needsUpdate=!0)},[]),e.jsxs(e.Fragment,{children:[e.jsx(Gt,{files:"/light.hdr",background:!1,frames:n?1:40}),e.jsx("color",{attach:"background",args:[r]}),e.jsx("fog",{attach:"fog",args:[r,25,120]}),e.jsx("ambientLight",{intensity:.4}),e.jsxs("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,renderOrder:-20,children:[e.jsx("planeGeometry",{args:[1e3,1e3]}),e.jsx(Xt,{ref:u,blur:n?[80,24]:[140,40],resolution:n?256:512,mixBlur:.6,mixStrength:.85,roughness:.94,metalness:0,mirror:.08,depthScale:.55,minDepthThreshold:.5,maxDepthThreshold:1.05,mixContrast:.85,dithering:!0,color:r,depthWrite:!0})]})]})}function hn({paused:a=!1}){const{setFrameloop:n,invalidate:r}=Je();return t.useEffect(()=>{try{n(a?"never":"always"),a||r()}catch{}},[a,n,r]),null}function gn(){const[a,n]=t.useState({forward:!1,backward:!1,left:!1,right:!1});return t.useEffect(()=>{const r=u=>{const m=u.key.toLowerCase();n(l=>{switch(m){case"w":case"arrowup":return{...l,forward:!0};case"s":case"arrowdown":return{...l,backward:!0};case"a":case"arrowleft":return{...l,left:!0};case"d":case"arrowright":return{...l,right:!0};default:return l}})},f=u=>{const m=u.key.toLowerCase();n(l=>{switch(m){case"w":case"arrowup":return{...l,forward:!1};case"s":case"arrowdown":return{...l,backward:!1};case"a":case"arrowleft":return{...l,left:!1};case"d":case"arrowright":return{...l,right:!1};default:return l}})};return window.addEventListener("keydown",r),window.addEventListener("keyup",f),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",f)}},[]),a}function St(a,n,r){const f=Math.PI*2;let u=(n-a+Math.PI)%f-Math.PI;return a+u*r}function xn({playerRef:a,portals:n=[],onPortalEnter:r,onProximityChange:f,onPortalsProximityChange:u,onNearPortalChange:m,navigateToPortalId:l=null,onReachedPortal:w,onOrbStateChange:M,sceneColor:v}){const{gl:L}=Je(),{scene:g,animations:y}=xt("/character.glb",!0,!0,x=>{try{const E=new Tt;E.setTranscoderPath("https://unpkg.com/three@0.179.1/examples/jsm/libs/basis/"),L&&E.detectSupport(L),x.setKTX2Loader&&x.setKTX2Loader(E)}catch{}}),{actions:d,mixer:S}=Ct(y,g),s=t.useRef(1),j=t.useRef(1),{camera:O}=Je(),q=t.useRef(!1),[H,me]=t.useState(!1),W=t.useRef(new T),de=t.useRef([]),ie=t.useRef(new T),ne=t.useRef([]),b=t.useRef(0),R=t.useRef({sphere:0,ring:0,splash:0,pos:new T}),G=1800,K=t.useRef(1/60),B=t.useRef(1/60),$=22,X=.6,ce=1,pe=60,Xe=t.useRef(new T(0,.8,0)),A=t.useRef(null),Z=t.useRef(null),F=t.useRef(new ee("#aee2ff")),oe=t.useRef(new ee("#9ec6ff")),he=t.useRef(1),ae=t.useRef(!1),ge=t.useRef(0),ve=t.useRef(0),J=t.useRef(!1),Ue=.06,We=.06,Ie=x=>{try{g.traverse(E=>{if(E.material){const k=E.material;if(Array.isArray(k))k.forEach(N=>{N.transparent=x<1,N.opacity=x,N.depthWrite=x>=1;try{N.emissive&&(N.emissive=new ee("#ffd480"),N.emissiveIntensity=1.6)}catch{}});else{k.transparent=x<1,k.opacity=x,k.depthWrite=x>=1;try{k.emissive&&(k.emissive=new ee("#ffd480"),k.emissiveIntensity=1.6)}catch{}}}})}catch{}};t.useEffect(()=>{if(g)try{g.traverse(x=>{if(!x||!x.isMesh||!x.material)return;(Array.isArray(x.material)?x.material:[x.material]).forEach(k=>{try{k&&k.emissive&&(k.emissive=new ee("#ffd480"),k.emissiveIntensity=1.6)}catch{}})})}catch{}},[g]),t.useEffect(()=>{if(!l||!a.current||q.current)return;let x=n.find(N=>N.id===l);if(!x&&l==="home"){W.current.set(0,0,0);try{a.current.position.set(0,pe,0)}catch{}ae.current=!0}else if(x)W.current.fromArray(x.position),ae.current=!1;else return;W.current.y=a.current.position.y,ge.current=0,ve.current=0,J.current=!0,q.current=!0,me(!0),typeof M=="function"&&M(!0),ke(!1),de.current=[],ne.current=[],ie.current.copy(a.current.position);try{x?.color?oe.current=new ee(x.color):oe.current=new ee("#9ec6ff")}catch{}const E=a.current.position.clone(),k=W.current.clone();he.current=Math.max(.001,k.distanceTo(E))},[l,n,a]),t.useEffect(()=>{try{Z.current&&Z.current.shadow&&(Z.current.shadow.autoUpdate=!1)}catch{}},[]),t.useEffect(()=>{try{const x=new Rt().setFromObject(g),E=new T;x.getCenter(E),Xe.current.copy(E)}catch{}},[g]);const ye=gn();t.useEffect(()=>{},[y,d]);const ke=ze.useCallback(x=>{if(g)try{g.traverse(E=>{E.isMesh&&(E.castShadow=!!x,E.receiveShadow=!1)})}catch{}},[g]);t.useEffect(()=>{ke(!0)},[ke]);const[je,be]=t.useMemo(()=>{const x=d?Object.keys(d):[],E="root|root|Iddle",k="root|root|Walking",N=x.includes(E)?E:x.find(we=>we.toLowerCase().includes("idle"))||x[0],re=x.includes(k)?k:x.find(we=>we.toLowerCase().includes("walk"))||x[1];return x.length&&(console.log("[Player] Using idle clip:",N),console.log("[Player] Using walk clip:",re)),[N,re]},[d]),Le=t.useRef(0),Te=1.65,$e=1.2;t.useEffect(()=>{if(!d)return;const x=je&&d[je],E=be&&d[be];if(x){x.reset().setEffectiveWeight(1).setEffectiveTimeScale(Te).play(),x.setLoop(ut,1/0),x.clampWhenFinished=!1;try{j.current=x.getClip()?.duration||j.current}catch{}}if(E){const k=Math.max(1,Ye/_e*$e);E.reset().setEffectiveWeight(0).setEffectiveTimeScale(k).play(),E.setLoop(ut,1/0),E.clampWhenFinished=!1;try{s.current=E.getClip()?.duration||s.current}catch{}}},[d,je,be]);const _e=5,Ye=8,Ee=3,Ce=4,Ve=12,Qe=t.useRef({}),et=t.useRef({portalId:null,untilS:0}),tt=1.6,dt=9,it=(x,E,k)=>{const N=se.clamp((k-x)/(E-x),0,1);return N*N*(3-2*N)};Ae((x,E)=>{if(!a.current)return;const k=Math.min(E,1/15),N=se.clamp(k,1/120,1/30);K.current=se.lerp(K.current,N,.18),B.current=k;const re=K.current;S&&(S.timeScale=1);try{Z.current&&Z.current.shadow&&(Z.current.shadow.autoUpdate=!!q.current)}catch{}if(q.current&&ge.current<1&&(ge.current=Math.min(1,ge.current+re/Ue),Ie(1-ge.current),ge.current>=1&&Ie(0)),!q.current&&J.current&&(ve.current=Math.min(1,ve.current+re/We),Ie(ve.current),ve.current>=1&&(J.current=!1,Ie(1),typeof M=="function"&&M(!1),ke(!0))),q.current){const C=a.current.position;de.current.push(C.clone()),de.current.length>120&&de.current.shift();const o=new T().subVectors(W.current,C),p=o.length();if(ae.current){C.y=Math.max(0,C.y-16*(B.current||re));const P=1-Math.pow(.001,B.current||re);C.x=se.lerp(C.x,0,P),C.z=se.lerp(C.z,0,P)}else{p>1e-6&&o.normalize();const Y=Math.min(p,$*(B.current||re));C.addScaledVector(o,Y)}if(A.current){const Y=W.current.distanceTo(C),P=se.clamp(1-Y/he.current,0,1),fe=F.current.clone().lerp(oe.current,P);A.current.emissive.copy(fe),A.current.color.copy(fe.clone().multiplyScalar(.9)),A.current.emissiveIntensity=5+2*P,A.current.needsUpdate=!0,Z.current&&(Z.current.color.copy(fe),Z.current.intensity=6+6*P,Z.current.distance=12,Z.current.decay=1.6,Z.current.shadow&&(Z.current.shadow.autoUpdate=!0))}const c=new T;a.current.getWorldPosition(c),c.add(new T(0,ce,0));const i=new T().subVectors(c,ie.current),h=i.length()/Math.max(B.current||re,1e-4),I=(i.lengthSq()>1e-8?i.clone().normalize():o.clone()).clone().multiplyScalar(-1),V=Math.abs(I.y)>.9?new T(1,0,0):new T(0,1,0),z=new T().crossVectors(I,V).normalize(),D=new T().crossVectors(I,z).normalize(),U=.5,Se=.28,Pe=8;for(let Y=0;Y<Pe;Y++){const P=U*Math.sqrt(Math.random()),fe=Math.random()*Math.PI*2,ct=z.clone().multiplyScalar(P*Math.cos(fe)).add(D.clone().multiplyScalar(P*Math.sin(fe))),lt=c.clone().addScaledVector(I,Se).add(ct),Oe=1.6,qe=I.clone().multiplyScalar(Math.min(5,.22*h)+Math.random()*.6).add(z.clone().multiplyScalar((Math.random()-.5)*Oe)).add(D.clone().multiplyScalar((Math.random()-.5)*Oe)).add(new T(0,Math.random()*.6,0));ne.current.push({pos:lt,vel:qe,life:.4+Math.random()*.6,kOverride:se.clamp(1-W.current.distanceTo(C)/he.current,0,1),t:"trail"})}if(ie.current.copy(c),!ae.current){const Y=Math.atan2(o.x,o.z),P=1-Math.pow(1e-4,re);a.current.rotation.y=St(a.current.rotation.y,Y,P)}if(!ae.current&&p<=X||ae.current&&C.y<=X){const Y=R.current.pos;a.current.getWorldPosition(Y),Y.add(new T(0,ce,0)),R.current.sphere=200,R.current.ring=100,R.current.splash=120,b.current=1.6;try{const P=ne.current;for(let fe=P.length-1;fe>=0;fe--)P[fe]&&P[fe].t==="trail"&&P.splice(fe,1)}catch{}a.current.position.y=0,ae.current=!1,ve.current=0,de.current=[],typeof w=="function"&&w(l),q.current=!1,me(!1)}return}const we=(ye.left?-1:0)+(ye.right?1:0),Q=(ye.forward?1:0)+(ye.backward?-1:0),Fe=Math.min(1,Math.abs(we)+Math.abs(Q)),Me=new T;O.getWorldDirection(Me),Me.y=0,Me.lengthSq()>0&&Me.normalize();const nt=new T().crossVectors(Me,new T(0,1,0)).normalize(),le=new T().addScaledVector(Me,Q).addScaledVector(nt,we),xe=le.lengthSq()>1e-6;if(xe){le.normalize();const C=Math.atan2(le.x,le.z),o=1-Math.pow(.001,re);a.current.rotation.y=St(a.current.rotation.y,C,o);const p=se.lerp(1,1.25,Fe),c=le.clone().multiplyScalar(Ye*p*(B.current||re));a.current.position.add(c)}if(d){const C=je&&d[je],o=be&&d[be];if(C&&o){C.loop!==ut&&C.setLoop(ut,1/0),o.loop!==ut&&o.setLoop(ut,1/0),C.clampWhenFinished=!1,o.clampWhenFinished=!1;const p=xe?1:0,c=1-Math.exp(-22*re);Le.current=se.clamp(se.lerp(Le.current,p,c),0,1);const i=Le.current,h=1-i;o.enabled=!0,C.enabled=!0,o.setEffectiveWeight(i),C.setEffectiveWeight(h);const _=Math.max(1,Ye/_e*$e),I=se.lerp(1,_,i);o.setEffectiveTimeScale(I),C.setEffectiveTimeScale(Te);try{const V=Math.max(.001,s.current),z=o.time%V,D=.001;z<D?o.time=D:V-z<D&&(o.time=V-D)}catch{}}}let ue=1/0;const He={},De=x.clock.getElapsedTime();let Ne=null,Re=1/0;if(n.forEach(C=>{const p=new T().fromArray(C.position).distanceTo(a.current.position);p<ue&&(ue=p),p<Re&&(Re=p,Ne=C.id);const c=!!Qe.current[C.id],i=p<Ee;p>Ce&&(Qe.current[C.id]=!1),!c&&i&&(et.current.portalId===C.id&&De<et.current.untilS||(Qe.current[C.id]=!0));const _=it(dt,tt,p);He[C.id]=se.clamp(_,0,1)}),f&&isFinite(ue)){const C=se.clamp(1-ue/Ve,0,1);f(C)}if(u&&u(He),m){const C=Re<Ee?Ne:null;m(C,Re)}});const ft=()=>{const x=t.useRef(),E=3e3,k=t.useRef(new Float32Array(E*3)),N=t.useRef({uBaseColor:{value:F.current.clone()},uTargetColor:{value:oe.current.clone()},uMix:{value:0},uPixelRatio:{value:Math.min(window.devicePixelRatio||1,2)},uSize:{value:.28},uOpacity:{value:.2}});return t.useEffect(()=>{x.current&&(x.current.setAttribute("position",new Be(k.current,3)),x.current.setDrawRange(0,0))},[]),Ae((re,we)=>{const Q=ne.current;if(!Q.length){x.current&&x.current.setDrawRange(0,0),N.current.uMix.value=0,N.current.uBaseColor.value.copy(F.current),N.current.uTargetColor.value.copy(oe.current);return}const Fe=60;if(R.current.sphere>0){const i=Math.min(Fe,R.current.sphere);for(let h=0;h<i;h++){const _=Math.random()*2-1,I=Math.random()*Math.PI*2,V=Math.sqrt(1-_*_),z=new T(V*Math.cos(I),_,V*Math.sin(I)),D=8+Math.random()*14,U=z.multiplyScalar(D);ne.current.length<G&&ne.current.push({pos:R.current.pos.clone(),vel:U,life:2.2+Math.random()*2.4,_life0:2.2})}R.current.sphere-=i}if(R.current.ring>0){const i=Math.min(Fe,R.current.ring);for(let h=0;h<i;h++){const _=Math.random()*Math.PI*2,V=new T(Math.cos(_),0,Math.sin(_)).multiplyScalar(12+Math.random()*10).add(new T(0,(Math.random()-.5)*2,0));ne.current.length<G&&ne.current.push({pos:R.current.pos.clone(),vel:V,life:2+Math.random()*2,_life0:2})}R.current.ring-=i}if(R.current.splash>0){const i=Math.min(Fe,R.current.splash),h=0;for(let _=0;_<i;_++){const I=Math.random()*Math.PI*2,V=Math.random()*.25,z=new T(Math.cos(I),0,Math.sin(I)),D=8+Math.random()*10,U=z.multiplyScalar(D),Se=R.current.pos.clone();Se.y=h+.06,Se.x+=Math.cos(I)*V,Se.z+=Math.sin(I)*V;const Pe={pos:Se,vel:U,life:2.2+Math.random()*2.8,_life0:2.2,_grounded:!0,_groundT:0};Pe.vel.x+=(Math.random()-.5)*2,Pe.vel.z+=(Math.random()-.5)*2,ne.current.length<G&&ne.current.push(Pe)}R.current.splash-=i}const Me=9.8*1,nt=a.current?a.current.position.y:0,le=.38,xe=.94,ue=K.current??Math.min(we,1/60);for(let i=Q.length-1;i>=0;i--){const h=Q[i];h.vel.y-=Me*ue,h.pos.addScaledVector(h.vel,ue),h.pos.y<=nt&&(h.pos.y=nt,h.vel.y=Math.abs(h.vel.y)*le,h._grounded=!0,h._groundT=(h._groundT||0)+ue,h.vel.x*=xe,h.vel.z*=xe,h._groundT>1.2&&(h.life-=ue*.18)),h._grounded?h.life-=ue*.03:(h.vel.x*=.9985,h.vel.z*=.9985,h.life-=ue*.04),h.life<=0&&Q.splice(i,1)}Q.length>G&&Q.splice(0,Q.length-G);const He=Math.min(Q.length,E),De=k.current;for(let i=0;i<He;i++)De[i*3+0]=Q[i].pos.x,De[i*3+1]=Q[i].pos.y,De[i*3+2]=Q[i].pos.z;x.current&&(x.current.setDrawRange(0,He),x.current.attributes.position.needsUpdate=!0);const Ne=a.current?.position||new T,Re=W.current.distanceTo(Ne),C=se.clamp(1-Re/Math.max(.001,he.current),0,1),o=new ee(v||"#ffffff"),p=F.current.clone().lerp(o,.3);N.current.uBaseColor.value.copy(p),N.current.uTargetColor.value.copy(oe.current),N.current.uMix.value=C,b.current>0&&(b.current=Math.max(0,b.current-ue*.6));const c=b.current;N.current.uSize.value=.28+.9*c,N.current.uOpacity.value=.2+.06*c}),e.jsxs("points",{frustumCulled:!1,children:[e.jsx("bufferGeometry",{ref:x}),e.jsx("shaderMaterial",{transparent:!0,depthWrite:!1,depthTest:!0,blending:kt,uniforms:N.current,vertexShader:`
            uniform float uPixelRatio;
            uniform float uSize;
            void main() {
              vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
              gl_Position = projectionMatrix * mvPosition;
              gl_PointSize = uSize * (180.0 / max(1.0, -mvPosition.z)) * uPixelRatio;
            }
          `,fragmentShader:`
            precision highp float;
            uniform vec3 uBaseColor;
            uniform vec3 uTargetColor;
            uniform float uMix;
            uniform float uOpacity;
            void main() {
              vec2 uv = gl_PointCoord * 2.0 - 1.0;
              float d = length(uv);
              if (d > 1.0) discard;
              float core = pow(1.0 - d, 5.0);
              float halo = pow(1.0 - d, 2.0) * 0.2;
              float alpha = clamp(core + halo, 0.0, 1.0) * uOpacity;
              vec3 col = mix(uBaseColor, uTargetColor, clamp(uMix, 0.0, 1.0)) * 0.6;
              gl_FragColor = vec4(col, alpha);
            }
          `})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("group",{ref:a,position:[0,0,0],children:[e.jsx("primitive",{object:g,scale:1.5}),e.jsxs("group",{position:[0,ce,0],children:[e.jsx("pointLight",{ref:Z,intensity:J.current?6:0,distance:12,decay:1.6,castShadow:!0,"shadow-mapSize-width":512,"shadow-mapSize-height":512,"shadow-bias":-6e-5,"shadow-normalBias":.02,"shadow-radius":8}),J.current&&e.jsx(e.Fragment,{children:e.jsxs("mesh",{children:[e.jsx("sphereGeometry",{args:[.6,24,24]}),e.jsx("meshStandardMaterial",{ref:A,emissive:new ee("#aee2ff"),emissiveIntensity:6.5,color:new ee("#f5fbff"),transparent:!0,opacity:.9})]})})]})]}),e.jsx(ft,{})]})}xt.preload("/character.glb");function yn({position:a=[0,0,0],color:n="#8ecae6",targetColor:r="#8ecae6",mix:f=0,size:u=2}){const m=t.useRef(),l=t.useRef();return Ae(()=>{if(m.current&&(m.current.rotation.z+=.01),l.current){const w=new ee(n),M=new ee(r),v=w.clone().lerp(M,se.clamp(f,0,1));l.current.color.copy(v),l.current.emissive.copy(v)}}),e.jsxs("mesh",{ref:m,position:a,rotation:[Math.PI/2,0,0],castShadow:!0,receiveShadow:!0,children:[e.jsx("torusGeometry",{args:[u,u*.1,16,32]}),e.jsx("meshStandardMaterial",{ref:l,color:n,emissive:n,emissiveIntensity:3.2})]})}function wn({playerRef:a,controlsRefExternal:n,shakeActive:r=!1,shakeAmplitude:f=.12,shakeFrequencyX:u=18,shakeFrequencyY:m=15,shakeYMultiplier:l=.9,enabled:w=!0}){const{camera:M}=Je(),v=t.useRef(),L=t.useMemo(()=>new T(0,2.4,-5.2),[]),g=t.useMemo(()=>new T(0,1.6,0),[]);return t.useEffect(()=>{n&&(n.current=v.current)},[n]),t.useEffect(()=>{if(!a.current)return;const y=a.current.rotation.y,d=new Vt().setFromEuler(new Ht(0,y,0)),S=L.clone().applyQuaternion(d),s=a.current.position,j=s.clone().add(g);M.position.copy(s).add(S),M.lookAt(j)},[M,a,L,g]),Ae(y=>{if(!a.current||!v.current||!w)return;const d=a.current.position.clone().add(g);if(r){const S=y.clock.getElapsedTime(),s=f;d.x+=Math.sin(S*u)*s,d.y+=Math.cos(S*m)*s*l}v.current.target.copy(d),v.current.update()}),e.jsx(Kt,{ref:v,enabled:w,enablePan:!1,enableDamping:!0,dampingFactor:.12,rotateSpeed:.8,minDistance:2.2,maxDistance:8,minPolarAngle:Math.PI*.2,maxPolarAngle:Math.PI*.49})}const vn=Zt({uFrom:new ee,uTo:new ee,uProgress:0},`
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = vec4(position.xy, 0.0, 1.0);
    }
  `,`
    uniform vec3 uFrom;
    uniform vec3 uTo;
    uniform float uProgress;
    varying vec2 vUv;
    void main() {
      float t = smoothstep(0.0, 1.0, uProgress);
      vec3 color = mix(uFrom, uTo, t);
      gl_FragColor = vec4(color, t);
    }
  `);Jt({TransitionMaterial:vn});function bn({active:a,fromColor:n,toColor:r,duration:f=1,onComplete:u,forceOnceKey:m}){const l=t.useRef(),w=t.useRef(null);return t.useEffect(()=>{let M=null;try{const v={v:0};M=Mt.fromTo(v,{v:0},{v:1,duration:.01})}catch{}return()=>{M&&M.kill()}},[]),t.useEffect(()=>{if(l.current){if(w.current&&(w.current.kill(),w.current=null),!a){l.current.uniforms.uProgress.value=0;return}l.current.uniforms.uFrom.value=new ee(n),l.current.uniforms.uTo.value=new ee(r),w.current=Mt.fromTo(l.current.uniforms.uProgress,{value:0},{value:1,duration:f,ease:"power2.inOut",onComplete:()=>{l.current&&(l.current.uniforms.uProgress.value=0),typeof u=="function"&&u()}})}},[a,n,r,f,u]),e.jsxs("mesh",{renderOrder:1e3,frustumCulled:!1,position:[0,0,0],children:[e.jsx("planeGeometry",{args:[2,2]}),e.jsx("transitionMaterial",{ref:l,transparent:!0})]},m)}function Mn({modelRef:a,glowVersion:n=0}){const{scene:r,animations:f}=xt("/character.glb",!0,!0,d=>{try{const S=new Tt;S.setTranscoderPath("https://unpkg.com/three@0.179.1/examples/jsm/libs/basis/"),d.setKTX2Loader&&d.setKTX2Loader(S)}catch{}}),u=t.useMemo(()=>Qt(r),[r]);t.useEffect(()=>{if(u)try{u.traverse(d=>{if(d&&d.isMesh&&d.material){if(Array.isArray(d.material))d.material=d.material.map(S=>{const s=S?.isMaterial?S.clone():S;return s&&s.isMaterial&&(s.transparent=!1,s.opacity=1,s.depthWrite=!0,s.userData={...s.userData||{},__portraitMaterial:!0}),s});else if(d.material.isMaterial){const S=d.material.clone();S.transparent=!1,S.opacity=1,S.depthWrite=!0,S.userData={...S.userData||{},__portraitMaterial:!0},d.material=S}}})}catch{}},[u]);const{actions:m}=Ct(f,u),l=t.useRef(new Map),w=t.useRef(new Set),M=t.useRef(new Map),v=t.useRef(new ee("#ffd480")),L=t.useRef(0),g=t.useRef(n),y=t.useMemo(()=>{const d=m?Object.keys(m):[],S="root|root|Iddle";return d.includes(S)?S:d.find(s=>s.toLowerCase().includes("idle"))||d[0]},[m]);return t.useEffect(()=>{if(!m||!y)return;Object.values(m).forEach(S=>S.stop());const d=m[y];d&&d.reset().fadeIn(.1).play()},[m,y]),t.useEffect(()=>{if(u){l.current.clear(),w.current.clear();try{u.traverse(d=>{if(!d||!d.isMesh||!d.material)return;(Array.isArray(d.material)?d.material:[d.material]).forEach(s=>{if(!s||!s.isMaterial)return;w.current.add(s);try{s.emissive&&M.current.set(s,{color:s.emissive.clone(),intensity:typeof s.emissiveIntensity=="number"?s.emissiveIntensity:1})}catch{}const j=s.onBeforeCompile;s.onBeforeCompile=O=>{try{O.uniforms.uGlow={value:0},O.uniforms.uGlowColor={value:new ee("#ffe9b0")};const q="gl_FragColor = vec4( outgoingLight, diffuseColor.a );",H=`
                vec3 _outGlow = outgoingLight + uGlowColor * (uGlow * 3.0);
                gl_FragColor = vec4(_outGlow, diffuseColor.a );
              `;O.fragmentShader.includes(q)&&(O.fragmentShader=O.fragmentShader.replace(q,H)),l.current.set(s,O.uniforms)}catch{}if(typeof j=="function")try{j(O)}catch{}},s.needsUpdate=!0})})}catch{}}},[u]),t.useEffect(()=>{n!==g.current&&(g.current=n,L.current=1)},[n]),Ae((d,S)=>{l.current.forEach(j=>{j&&j.uGlow&&(j.uGlow.value=1)}),w.current.forEach(j=>{try{const O=M.current.get(j);if(!O||!j.emissive)return;j.emissive.copy(v.current),j.emissiveIntensity=Math.max(0,(O.intensity||1)+8)}catch{}})}),e.jsx("group",{position:[0,-1.45,0],children:e.jsx("primitive",{ref:a,object:u,scale:1.65})})}function Sn({y:a,zoom:n}){const{camera:r}=Je();return Ae(()=>{r&&(r.position.set(0,a,10),r.rotation.set(0,0,0),typeof r.zoom=="number"&&(r.zoom=n),r.updateProjectionMatrix())}),null}function jn({modelRef:a,intensity:n,angle:r,penumbra:f,posY:u,posZ:m,color:l}){const w=t.useRef(null),M=t.useRef(null),v=t.useRef(null),L=t.useRef({target:new T,size:new T,box:new Rt});return t.useEffect(()=>{if(!a.current)return;let g=null;a.current.traverse(y=>{!g&&y.name&&/head/i.test(y.name)&&(g=y)}),v.current=g},[a]),Ae(()=>{if(!w.current||!M.current||!a.current)return;const{target:g,size:y,box:d}=L.current;v.current?v.current.getWorldPosition(g):(d.setFromObject(a.current),d.getCenter(g),d.getSize(y),g.y=d.max.y-y.y*.1),M.current.position.copy(g),w.current.target=M.current,w.current.target.updateMatrixWorld()}),e.jsxs(e.Fragment,{children:[e.jsx("spotLight",{ref:w,position:[0,u,m],angle:r,penumbra:f,intensity:n,color:l}),e.jsx("object3D",{ref:M})]})}function Cn({dotEnabled:a=!0,dotScale:n=1,dotAngle:r=Math.PI/4,dotCenterX:f=.38,dotCenterY:u=.44,dotOpacity:m=.04,dotBlend:l="screen",showUI:w=!0,onEggActiveChange:M,glowVersion:v=0}){const L=t.useRef(),g=t.useRef(null),y=t.useRef(null),d=.8,S=-1,s=160,j=15,O=t.useRef(0),q=ze.useMemo(()=>{if(typeof window>"u"||typeof navigator>"u")return!1;const c=navigator.userAgent||"",i=/Mobi|Android|iPhone|iPad|iPod/i.test(c),h=typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)").matches,_=navigator.connection&&(navigator.connection.saveData||navigator.connection.effectiveType&&/2g/.test(navigator.connection.effectiveType)),I=navigator.deviceMemory&&navigator.deviceMemory<=4,V=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<=4,z=window.devicePixelRatio&&window.devicePixelRatio>2;return!!(i||h||_||I||V||z)},[]),[H,me]=t.useState(20),[W,de]=t.useState(1),[ie,ne]=t.useState(.28),[b,R]=t.useState(2.7),[G,K]=t.useState(-.2),[B,$]=t.useState("#ffffff"),[X,ce]=t.useState(!1),[pe,Xe]=t.useState(!1),[A,Z]=t.useState({x:0,y:0}),[F,oe]=t.useState(1),[he,ae]=t.useState(d),[ge,ve]=t.useState(s),J=t.useRef(!1),Ue=t.useRef({y:0,camY:d}),We=t.useRef([]),Ie=t.useRef(0),ye=t.useRef(null),ke=t.useRef(null);t.useEffect(()=>{const i=new Array(8).fill(null).map(()=>{const h=new Audio("/punch.mp3");h.preload="auto",h.volume=.8;try{h.load()}catch{}return h});return We.current=i,()=>{We.current=[]}},[]),t.useEffect(()=>{const c=window.AudioContext||window.webkitAudioContext;if(!c)return;const i=new c;ye.current=i;let h=!1;return(async()=>{try{const I=await(await fetch("/punch.mp3",{cache:"force-cache"})).arrayBuffer(),V=await i.decodeAudioData(I);h||(ke.current=V)}catch{}})(),()=>{h=!0;try{i.close()}catch{}}},[]);const je=t.useMemo(()=>["Even after life, you poke my very soul to make your logo bigger? Let me rest…","Yeah, a graphic designer's job is also to entertain you, right?","Fuck off, I'm tired of you…","Did you know that this is considered bullying, right?","Everything OK at home?","So this is what it feels like not being registered in social security?","“Let me rest… go away, dude!”","If you keep poking my soul, I will not make your logo bigger.","I'm sending you an invoice for this, OK?","I will report you for using pirate software.","¡Deja de chingar! …That's what my uncle says when he's mad."],[]),[be,Le]=t.useState(!1),[Te,$e]=t.useState(""),_e=t.useRef(null),Ye=t.useRef(null),Ee=t.useRef(0),Ce=t.useRef(0),Ve=t.useRef(!1);t.useEffect(()=>{Ve.current=be},[be]);async function Qe(){const c=typeof performance<"u"?performance.now():Date.now();O.current=c+480,oe(1.9),window.setTimeout(()=>oe(.96),110),window.setTimeout(()=>oe(1.08),200),window.setTimeout(()=>oe(1),280);let i=!1;const h=ye.current,_=ke.current;if(h&&_){try{h.state!=="running"&&await h.resume()}catch{}try{const z=h.createBufferSource();z.buffer=_;const D=h.createGain();D.gain.value=.9,z.connect(D).connect(h.destination),z.start(0),i=!0}catch{}}if(!i){const z=We.current;if(z&&z.length){const D=Ie.current%z.length;Ie.current+=1;const U=z[D];try{U.currentTime=0}catch{}try{U.play()}catch{}}}const I=Date.now();if(I-Ce.current>600&&(Ee.current=0),Ce.current=I,Ee.current+=1,Ee.current>3&&!be){const z=je[Math.floor(Math.random()*je.length)];$e(z),Le(!0),typeof M=="function"&&M(!0),we(z),N(!0),Re("egg"),C.current&&window.clearTimeout(C.current),o.current&&window.clearTimeout(o.current),requestAnimationFrame(()=>{const U=g.current,Se=Q.current;if(U&&Se){const Pe=(Dt,Ot,Bt)=>Math.max(Ot,Math.min(Bt,Dt)),Y=U.getBoundingClientRect(),P=Se.getBoundingClientRect(),fe=-18,ct=-18;let lt=Pe(Y.top+Y.height*.25-P.height*.3,8,window.innerHeight-P.height-8),Oe=Y.right+fe;const qe=Oe+P.width<=window.innerWidth-8;let Ke=Y.top-P.height-ct,yt=Pe(Y.left+Y.width/2-P.width/2,8,window.innerWidth-P.width-8);const wt=Ke>=8;let ot=0,at=0;qe?(le("right"),ot=lt,at=Oe):wt?(le("top"),ot=Ke,at=yt):(le("right"),Oe=Pe(Oe,8,window.innerWidth-P.width-8),ot=lt,at=Oe),Me({top:ot,left:at});const rt=at+P.width/2,mt=ot+P.height/2,pt=Y.left+Y.width*.1,ht=Y.top+Y.height*.35,st=Math.atan2(ht-mt,pt-rt),gt=P.width/2+Math.cos(st)*(P.width/2-6),vt=P.height/2+Math.sin(st)*(P.height/2-6),bt=10,Lt=gt+Math.cos(st)*bt,_t=vt+Math.sin(st)*bt;ue({x:gt,y:vt,cx:Lt,cy:_t,angleDeg:st*180/Math.PI})}});const D=7e3;Ye.current&&window.clearTimeout(Ye.current),Ye.current=window.setTimeout(()=>{Re("normal")},D),Ee.current=0,_e.current&&window.clearTimeout(_e.current),_e.current=window.setTimeout(()=>{N(!1),Le(!1),$e(""),Re("normal"),typeof M=="function"&&M(!1);const U=800;C.current=window.setTimeout(()=>{if(!Ve.current){const Se=E[Math.floor(Math.random()*E.length)];we(Se),N(!0)}},U)},D)}}function et(){Xe(!0);const c=ye.current;c&&c.state!=="running"&&c.resume().catch(()=>{})}function tt(){Xe(!1),J.current=!1}function dt(c){const i=y.current;if(!i)return;const h=i.getBoundingClientRect();if(Z({x:c.clientX-h.left,y:c.clientY-h.top}),J.current){const _=c.clientY-Ue.current.y,I=Ue.current.camY-_*.01;ae(Math.max(S,Math.min(d,I)))}}function it(c){J.current=!0,Ue.current={y:c.clientY,camY:he}}function ft(){J.current=!1}function x(c){const i=ge-c.deltaY*.06;ve(Math.max(j,Math.min(s,i)))}const E=t.useMemo(()=>["Yeah, well, AI killed graphic designers and here i am, fucking entertaining you...","I didn’t starve, I was just doing intermittent fasting… forever.","Turns out my portfolio wasn’t compatible with ChatGPT.","I asked MidJourney for food, it gave me a moodboard.","AI ate my job, so I ate… nothing.","They said design feeds the soul. Pity it doesn’t feed the stomach.","At least my hunger pangs come in a nice minimalist grid.","I died in Helvetica Bold, not Comic Sans.","Clients still ghosted me… now permanently.","AI doesn’t sleep, but apparently I don’t eat.","At my funeral, please kerning the flowers properly.","I asked DALL·E for bread… it gave me a surrealist painting of toast.","Even my gravestone has better alignment than my old invoices.","AI doesn’t get paid, but neither did I.","Starving for art was supposed to be metaphorical.","At least my hunger made me pixel-perfect thin.","My last meal was RGB soup with a side of CMYK crumbs.","No one wanted to pay for logos, but hey, I died branded.","AI makes logos in 5 seconds. I made one in 5 days… then died.","My obituary will be in Arial, because I wasn’t worth a typeface license.","I thought I was irreplaceable. AI thought otherwise.","Hungry, but at least my color palette was vibrant.","They asked for unlimited revisions. I gave them unlimited silence.","I went from freelancing to free starving.","AI doesn’t complain about exposure. I just died from it.","Design used to keep me alive. Now it’s just keeping my Behance alive.","I tried to barter my Photoshop skills for tacos. Didn’t work.","The only thing left aligned in my life was my coffin.","I asked for a client brief. Life gave me a death brief.","AI makes mistakes too… but at least it doesn’t need lunch.","I’m not gone, I’m just on the ultimate creative break.","I used to design posters. Now I’m the poster child of unemployment.","My diet? Strictly vector-based.","Clients said: ‘Can you make it pop?’ — my stomach did.","I always wanted to be timeless. Death helped.","I finally reached negative space: my fridge.","I exported myself… as a ghost.","They paid me in exposure. Turns out exposure kills.","At least AI can’t feel hunger… lucky bastard.","I designed my own tombstone. Minimalist. No budget.","I was 99% caffeine, 1% hope.","Starved, but hey—my resume is still responsive.","I left life on draft mode.","They said design is forever. Guess rent isn’t.","No more clients asking for ‘one last change’… finally.","My life was low budget, but high resolution.","I aligned everything… except my destiny.","AI took my clients. Hunger took my soul.","I’m trending now… in the obituary section.","I wanted to go viral. Ended up going vital… signs flat.","I kerning-ed myself into the grave.","The only thing scalable now is my skeleton.","I asked life for balance. It gave me imbalance and starvation.","They’ll miss me when AI starts using Comic Sans.","I worked for peanuts… wish I had actual peanuts.","Dead, but at least I’m vector — infinitely scalable.","They automated design. Can they automate tacos too?","Death was my final deadline.","AI makes perfect gradients. Mine was starvation to extinction.","I asked the universe for feedback. It replied: ‘Looks good, but you’re gone.’","I didn’t lose my job. I just Ctrl+Z’d out of existence."],[]),[k,N]=t.useState(!1),[re,we]=t.useState(""),Q=t.useRef(null),[Fe,Me]=t.useState({top:-9999,left:-9999}),[nt,le]=t.useState("right"),[xe,ue]=t.useState({x:0,y:0,cx:0,cy:0,angleDeg:0}),[He,De]=t.useState(!1),[Ne,Re]=t.useState("normal"),C=t.useRef(null),o=t.useRef(null);t.useEffect(()=>{function c(h,_,I){return Math.max(_,Math.min(I,h))}function i(){const h=4e3+Math.random()*5e3;C.current=window.setTimeout(()=>{if(Ve.current){i();return}const _=E[Math.floor(Math.random()*E.length)];we(_),N(!0),De(!1),requestAnimationFrame(()=>{const V=g.current,z=Q.current;if(!V||!z)return;const D=V.getBoundingClientRect(),U=z.getBoundingClientRect(),Se=-18,Pe=-18;let Y=c(D.top+D.height*.25-U.height*.3,8,window.innerHeight-U.height-8),P=D.right+Se;const fe=P+U.width<=window.innerWidth-8;let ct=D.top-U.height-Pe,lt=c(D.left+D.width/2-U.width/2,8,window.innerWidth-U.width-8);const Oe=ct>=8;let qe=0,Ke=0;fe?(le("right"),qe=Y,Ke=P):Oe?(le("top"),qe=ct,Ke=lt):(le("right"),P=c(P,8,window.innerWidth-U.width-8),qe=Y,Ke=P),Me({top:qe,left:Ke});const yt=Ke+U.width/2,wt=qe+U.height/2,ot=D.left+D.width*.1,at=D.top+D.height*.35,rt=Math.atan2(at-wt,ot-yt),mt=U.width/2+Math.cos(rt)*(U.width/2-6),pt=U.height/2+Math.sin(rt)*(U.height/2-6),ht=10,st=mt+Math.cos(rt)*ht,gt=pt+Math.sin(rt)*ht;ue({x:mt,y:pt,cx:st,cy:gt,angleDeg:rt*180/Math.PI}),De(!0)});const I=6500+Math.random()*3e3;o.current=window.setTimeout(()=>{N(!1),Re("normal"),i()},I)},h)}return i(),()=>{C.current&&window.clearTimeout(C.current),o.current&&window.clearTimeout(o.current)}},[E]);const p=async()=>{const c=`{
  "intensity": ${H},
  "angle": ${W},
  "penumbra": ${ie},
  "posY": ${b},
  "posZ": ${G},
  "color": "${B}"
}`;try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(c);else{const i=document.createElement("textarea");i.value=c,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i)}ce(!0),setTimeout(()=>ce(!1),1200)}catch(i){console.warn("No se pudo copiar al portapapeles",i)}};return e.jsxs("div",{ref:g,className:"fixed left-10 bottom-10 flex gap-3 items-end",children:[k&&e.jsxs("div",{ref:Q,className:`pointer-events-none fixed z-50 max-w-56 px-3 py-2.5 rounded-[18px] border-[3px] text-[13px] leading-snug shadow-[6px_6px_0_#000] rotate-[-1.5deg] ${Ne==="egg"?"bg-black border-black text-white":"bg-[#fff7df] border-black text-black"}`,style:{top:Fe.top,left:Fe.left},children:[Ne==="normal"&&e.jsx("div",{className:"pointer-events-none absolute inset-0 opacity-15 mix-blend-multiply rounded-[16px]",style:{backgroundImage:"radial-gradient(currentColor 1px, transparent 1px), radial-gradient(currentColor 1px, transparent 1px)",backgroundSize:"10px 10px, 10px 10px",backgroundPosition:"0 0, 5px 5px",color:"#111"}}),e.jsx("div",{className:"absolute inset-0 rounded-[16px] border border-black/20 pointer-events-none"}),e.jsx("div",{className:"relative font-semibold tracking-wide px-2 text-center uppercase text-[14px] sm:text-[15px]",style:{fontFamily:'"Comic Neue", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif'},children:re}),e.jsx("div",{className:`absolute w-3.5 h-3.5 -translate-x-1/2 -translate-y-1/2 ${Ne==="egg"?"bg-white":"bg-black"}`,style:{left:`${xe.x}px`,top:`${xe.y}px`,transform:`translate(-50%, -50%) rotate(${xe.angleDeg}deg)`}}),e.jsx("div",{className:`absolute w-3 h-3 -translate-x-1/2 -translate-y-1/2 ${Ne==="egg"?"bg-black":"bg-[#fff7df]"}`,style:{left:`${xe.cx}px`,top:`${xe.cy}px`,transform:`translate(-50%, -50%) rotate(${xe.angleDeg}deg)`}})]}),e.jsxs("div",{ref:y,className:`pointer-events-auto cursor-pointer relative w-44 h-72 sm:w-48 sm:h-80 rounded-full overflow-hidden border border-white/20 shadow-lg transform-gpu will-change-transform transition-transform duration-200 ease-out hover:scale-105 ${be?"bg-red-600":"bg-[#06061D]"}`,onClick:Qe,onMouseEnter:et,onMouseLeave:tt,onMouseMove:dt,onMouseDown:it,onMouseUp:ft,onWheel:x,"aria-label":"Retrato personaje",title:"",style:{cursor:"none"},children:[e.jsxs(Et,{dpr:[1,q?1.2:1.5],orthographic:!0,camera:{position:[0,he,10],zoom:ge,near:-100,far:100},gl:{antialias:!1,powerPreference:"high-performance",alpha:!0,stencil:!1},children:[e.jsx(Sn,{y:he,zoom:ge}),e.jsx("ambientLight",{intensity:.8}),e.jsx("directionalLight",{intensity:.7,position:[2,3,3]}),e.jsx(Mn,{modelRef:L,glowVersion:v}),e.jsx("group",{position:[0,0,0]}),e.jsx(jn,{modelRef:L,intensity:H,angle:W,penumbra:ie,posY:b,posZ:G,color:B}),e.jsxs(Ft,{multisampling:0,disableNormalPass:!0,children:[a&&e.jsx(Nt,{blendFunction:{normal:te.NORMAL,multiply:te.MULTIPLY,screen:te.SCREEN,overlay:te.OVERLAY,softlight:te.SOFT_LIGHT,add:te.ADD,darken:te.DARKEN,lighten:te.LIGHTEN}[(l||"normal").toLowerCase()]||te.NORMAL,angle:r,scale:n,center:[f,u],opacity:m}),be&&e.jsxs(e.Fragment,{children:[e.jsx(Pt,{offset:[.012,.009]}),e.jsx(At,{delay:[.02,.06],duration:[.6,1.4],strength:[1,1.8],mode:It.CONSTANT,active:!0,columns:.006})]})]})]}),e.jsx("img",{src:"/slap.svg",alt:"slap",draggable:"false",className:"pointer-events-none select-none absolute",style:{left:`${A.x}px`,top:`${A.y}px`,width:"80px",height:"80px",transform:`translate(-50%, -50%) scale(${F})`,opacity:pe?1:0,transition:"transform 90ms ease-out, opacity 120ms ease-out"}})]}),w&&e.jsxs("div",{className:"pointer-events-auto select-none p-2 rounded-md bg-black/50 text-white w-52 space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold opacity-90",children:"UI de retrato"}),e.jsx("div",{className:"text-[11px] font-medium opacity-80 mt-1",children:"Cámara"}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Altura Y: ",he.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:S,max:d,step:"0.01",value:he,onChange:c=>ae(parseFloat(c.target.value))})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Zoom: ",Math.round(ge),e.jsx("input",{className:"w-full",type:"range",min:j,max:s,step:"1",value:ge,onChange:c=>ve(parseFloat(c.target.value))})]}),e.jsx("button",{type:"button",className:"mt-1 w-full py-1.5 text-[12px] rounded bg-white/10 hover:bg-white/20 transition-colors",onClick:async()=>{const c=JSON.stringify({camY:parseFloat(he.toFixed(2)),camZoom:Math.round(ge)},null,2);try{await navigator.clipboard.writeText(c)}catch{const i=document.createElement("textarea");i.value=c,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i)}},children:"Copiar preset Cámara"}),e.jsx("div",{className:"h-px bg-white/10 my-1"}),e.jsx("div",{className:"text-[11px] font-medium opacity-80",children:"Luz"}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Intensidad: ",H.toFixed(1),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"20",step:"0.1",value:H,onChange:c=>me(parseFloat(c.target.value))})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Ángulo: ",W.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.1",max:"1.0",step:"0.01",value:W,onChange:c=>de(parseFloat(c.target.value))})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Penumbra: ",ie.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:ie,onChange:c=>ne(parseFloat(c.target.value))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"flex-1 block text-[11px] opacity-80",children:["Altura Y",e.jsx("input",{className:"w-full",type:"range",min:"1.0",max:"3.5",step:"0.05",value:b,onChange:c=>R(parseFloat(c.target.value))})]}),e.jsxs("label",{className:"flex-1 block text-[11px] opacity-80",children:["Dist Z",e.jsx("input",{className:"w-full",type:"range",min:"-3.0",max:"-0.2",step:"0.02",value:G,onChange:c=>K(parseFloat(c.target.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] opacity-80",children:[e.jsx("span",{children:"Color"}),e.jsx("input",{type:"color",value:B,onChange:c=>$(c.target.value),className:"h-6 w-10 bg-transparent border-0 outline-none cursor-pointer"})]}),e.jsx("button",{type:"button",onClick:p,className:"mt-1 w-full py-1.5 text-[12px] rounded bg-white/10 hover:bg-white/20 transition-colors",children:X?"¡Copiado!":"Copiar valores"})]})]})}xt.preload("/character.glb");function Rn({lowPerf:a=!1,eggActiveGlobal:n=!1,bloom:r=.25,vignette:f=.7,noise:u=.08,dotEnabled:m=!0,dotScale:l=1,dotAngle:w=Math.PI/4,dotCenterX:M=.5,dotCenterY:v=.5,dotOpacity:L=1,dotBlend:g="normal",godEnabled:y=!1,godSun:d=null,godDensity:S=.9,godDecay:s=.95,godWeight:j=.6,godExposure:O=.3,godClampMax:q=1,godSamples:H=60,dofEnabled:me=!1,dofProgressive:W=!0,dofFocusDistance:de=.2,dofFocalLength:ie=.02,dofBokehScale:ne=3,dofFocusSpeed:b=.08,dofTargetRef:R=null}){const K=t.useMemo(()=>({normal:te.NORMAL,multiply:te.MULTIPLY,screen:te.SCREEN,overlay:te.OVERLAY,softlight:te.SOFT_LIGHT,add:te.ADD,darken:te.DARKEN,lighten:te.LIGHTEN}),[])[(g||"normal").toLowerCase()]??te.NORMAL,{camera:B}=Je(),$=t.useRef(de);Ae(()=>{if(!me||!W||!R?.current)return;const ce=new T;R.current.getWorldPosition(ce),ce.applyMatrix4(B.matrixWorldInverse);const pe=-ce.z,Xe=se.clamp((pe-B.near)/(B.far-B.near),0,1);$.current=se.lerp($.current,Xe,b)});const X=t.useMemo(()=>`gr:${y?1:0}:${S.toFixed(3)}:${s.toFixed(3)}:${j.toFixed(3)}:${O.toFixed(3)}:${q.toFixed(3)}:${H}`,[y,S,s,j,O,q,H]);return e.jsx(e.Fragment,{children:e.jsxs(Ft,{multisampling:0,disableNormalPass:!0,children:[!a&&e.jsx(en,{}),e.jsx(tn,{mipmapBlur:!0,intensity:r,luminanceThreshold:.86,luminanceSmoothing:.18}),e.jsx(nn,{mode:mn.ACES_FILMIC}),!a&&me&&e.jsx(on,{focusDistance:W?$.current:de,focalLength:ie,bokehScale:ne}),!n&&e.jsx(an,{eskil:!1,offset:.15,darkness:f}),!a&&y&&d?.current&&e.jsx(rn,{sun:d.current,density:S,decay:s,weight:j,exposure:O,clampMax:q,samples:H,blendFunction:te.SCREEN},X),m&&!a&&e.jsx(Nt,{blendFunction:K,angle:w,scale:l,center:[M,v],opacity:L}),e.jsx(sn,{premultiply:!0,blendFunction:te.SOFT_LIGHT,opacity:a?Math.min(u,.04):u}),n&&!a&&e.jsxs(e.Fragment,{children:[e.jsx(Pt,{offset:[.01,.008]}),e.jsx(At,{delay:[.02,.08],duration:[.5,1.2],strength:[.9,1.6],mode:It.CONSTANT,active:!0,columns:.005})]})]})})}function kn({playerRef:a,height:n=6,intensity:r=2.5,color:f="#ffffff",angle:u=.8,penumbra:m=.6}){const l=t.useRef(),w=t.useRef(),M=t.useRef(new T),v=t.useRef(new T);return Ae((L,g)=>{if(!a.current||!l.current||!w.current)return;const y=1-Math.pow(.001,g);M.current.copy(a.current.position),M.current.y+=n,v.current.copy(a.current.position),v.current.y+=1.6,l.current.position.lerp(M.current,y),w.current.position.lerp(v.current,y),l.current.target=w.current,l.current.target.updateMatrixWorld()}),e.jsxs(e.Fragment,{children:[e.jsx("spotLight",{ref:l,color:f,intensity:r,angle:u,penumbra:m,distance:50,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-bias":-6e-5,"shadow-normalBias":.02,"shadow-radius":8}),e.jsx("object3D",{ref:w})]})}function Tn({center:a=[0,0,0],radius:n=3.5,count:r=240,color:f="#c7d2fe",targetColor:u="#ffffff",mix:m=0,playerRef:l,frenzyRadius:w=10}){const v=t.useMemo(()=>new Float32Array(r),[r]),L=t.useMemo(()=>new Float32Array(r),[r]),g=t.useMemo(()=>new Float32Array(r),[r]),y=t.useMemo(()=>new Float32Array(r),[r]),d=t.useMemo(()=>new Float32Array(r),[r]),S=t.useMemo(()=>new Float32Array(r),[r]),s=t.useMemo(()=>new Float32Array(r),[r]),j=t.useMemo(()=>new Float32Array(r),[r]),O=t.useMemo(()=>new T().fromArray(a),[a]),q=t.useRef(),H=t.useRef(),me=t.useRef(),W=t.useRef([]);t.useRef(null);const de=t.useRef({world:new T,bone:new T});t.useMemo(()=>{for(let b=0;b<r;b+=1){const R=b/r*Math.PI*2,G=Math.random(),K=n*Math.pow(G,.65);v[b]=R,L[b]=K;const B=Math.sin((b+.5)*12.9898)*43758.5453,$=B-Math.floor(B),X=$*$*$;g[b]=X*1.6-.2,y[b]=.3+Math.random()*.5,d[b]=.6+Math.random()*.8,S[b]=Math.random()*Math.PI*2,s[b]=.05+Math.random()*.12,j[b]=Math.floor(Math.random()*32)}},[r,n,v,L,g,y,d,S,s]);const ie=t.useRef({uTime:{value:0},uCenter:{value:new T().fromArray(a)},uPlayer:{value:new T},uFrenzy:{value:0},uColor:{value:new ee(f)},uTargetColor:{value:new ee(u)},uMix:{value:m},uPixelRatio:{value:Math.min(window.devicePixelRatio||1,2)},uRadius:{value:n},uBoneCount:{value:0},uBones:{value:new Array(32).fill(0).map(()=>new T)}});t.useEffect(()=>{const b=ie.current;b.uCenter.value.fromArray(a),b.uColor.value.set(f),b.uTargetColor.value.set(u),b.uRadius.value=n,b.uMix.value=m},[a,f,u,n,m]),Ae(b=>{const R=ie.current;if(R.uMix.value=m,R.uTargetColor.value.set(u),R.uTime.value=b.clock.getElapsedTime(),b.gl){const G=b.gl.getPixelRatio?b.gl.getPixelRatio():window.devicePixelRatio||1;R.uPixelRatio.value=Math.min(G,2)}if(l?.current){if(W.current.length===0){let $=null;if(l.current.traverse(X=>{!$&&X.isSkinnedMesh&&X.skeleton&&($=X)}),$&&$.skeleton&&$.skeleton.bones?.length)W.current=$.skeleton.bones.slice();else{const X=[];l.current.traverse(ce=>{ce.isBone&&X.push(ce)}),X.length&&(W.current=X)}}const G=Math.min(32,W.current.length);R.uBoneCount.value=G;const K=q.current?q.current.getWorldPosition(de.current.world):O;if(G>0)for(let $=0;$<32;$+=1){const X=R.uBones.value[$];$<G?(W.current[$].getWorldPosition(de.current.bone),X.copy(de.current.bone).sub(K)):X.set(0,0,0)}const B=K.distanceTo(l.current.position);R.uFrenzy.value=se.clamp(1-B/w,0,1),R.uPlayer.value.copy(l.current.position).sub(K),R.uCenter.value.set(0,0,0)}else ie.current.uFrenzy.value=0});const ne=t.useMemo(()=>new Float32Array(r*3),[r]);return t.useEffect(()=>{if(!H.current)return;const b=H.current;try{b.setAttribute("position",new Be(ne,3)),b.setAttribute("aBaseAngle",new Be(v,1)),b.setAttribute("aBaseRadius",new Be(L,1)),b.setAttribute("aBaseY",new Be(g,1)),b.setAttribute("aSize",new Be(y,1)),b.setAttribute("aFreq",new Be(d,1)),b.setAttribute("aSeed",new Be(S,1)),b.setAttribute("aTight",new Be(s,1)),b.setAttribute("aBoneSlot",new Be(j,1)),b.computeBoundingSphere()}catch{}},[H,ne,v,L,g,y,d,S,s,j]),e.jsxs("points",{ref:q,frustumCulled:!1,renderOrder:-25,children:[e.jsx("bufferGeometry",{ref:H}),e.jsx("shaderMaterial",{ref:me,transparent:!0,depthWrite:!1,depthTest:!0,blending:kt,uniforms:ie.current,vertexShader:`
          precision highp float;
          attribute float aBaseAngle;
          attribute float aBaseRadius;
          attribute float aBaseY;
          attribute float aSize;
          attribute float aFreq;
          attribute float aSeed;
          attribute float aTight;
          attribute float aBoneSlot;
          uniform float uTime;
          uniform float uRadius;
          uniform float uFrenzy;
          uniform float uPixelRatio;
          uniform vec3 uCenter;
          uniform vec3 uPlayer;
          uniform float uBoneCount;
          uniform vec3 uBones[32];
          varying float vLife;
          varying float vFrenzy;
          void main() {
            vFrenzy = uFrenzy;
            // Life pulse [0..1] for subtle brightness modulation
            float cycle = fract(uTime * aFreq + aSeed);
            float fadeIn = smoothstep(0.0, 0.2, cycle);
            float fadeOut = 1.0 - smoothstep(0.8, 1.0, cycle);
            vLife = fadeIn * fadeOut;

            // Reduced ring feel + freer wander
            float ang = aBaseAngle
              + uTime * (0.06 + aFreq * 0.04) * (1.0 + uFrenzy * 0.8)
              + sin(uTime * 0.18 + aSeed) * 0.08 * (1.0 + uFrenzy * 0.6);
            float rWave = 1.0 + 0.03 * sin(uTime * 0.18 + aSeed);
            float rExpand = 1.0 + 0.8 * uFrenzy;
            float rBase = aBaseRadius * rWave * rExpand;
            float r = mix(rBase, aTight * 0.8, clamp(uFrenzy * 1.05, 0.0, 1.0));

            float y = (aBaseY * (1.0 + 0.5 * uFrenzy)) + 0.2 * sin(uTime * 0.28 + aSeed);

            // Interpolate center towards a selected bone when close (stick to body)
            int boneCount = int(uBoneCount);
            int slot = int(mod(aBoneSlot, max(float(boneCount), 1.0)));
            vec3 bonePos = (boneCount > 0) ? uBones[slot] : uCenter;
            vec3 centerCurr = mix(uCenter, bonePos, clamp(uFrenzy, 0.0, 1.0));
            vec3 pos = vec3(cos(ang) * r, y, sin(ang) * r) + centerCurr;
            // Órbita local apretada alrededor del hueso cuando muy cerca
            vec3 p1 = normalize(vec3(sin(aSeed*1.3), 0.0, cos(aSeed*2.1)));
            vec3 p2 = normalize(cross(p1, vec3(0.0,1.0,0.0)));
            float lr = aTight * 1.2 * uFrenzy;
            vec3 localOrb = p1 * sin(uTime*(2.2 + aFreq*1.5)) + p2 * cos(uTime*(2.6 + aFreq));
            pos += localOrb * lr;
            // Free 3D wander
            float amp = 0.6 + 1.2 * uFrenzy; // wander más amplio
            vec3 wander = vec3(
              sin(uTime * (0.55 + aFreq) + aSeed * 1.1) + sin(uTime * 0.73 + aSeed * 2.0),
              sin(uTime * (0.41 + aFreq) + aSeed * 1.7),
              cos(uTime * (0.47 + aFreq * 0.9) + aSeed * 1.3)
            ) * 0.25 * amp;
            pos += wander;

            // Enjambre: alrededor del jugador de forma aleatoria
            // Dirección hacia el jugador con offset leve a la cabeza
            vec3 dir = normalize(uPlayer - pos + vec3(0.0, 1.2, 0.0));
            float h = fract(sin(aSeed * 12.9898) * 43758.5453);
            vec3 up = vec3(0.0, 1.0, 0.0);
            vec3 ortho = normalize(cross(dir, up));
            float wiggle = sin(uTime * (1.8 + aFreq) + aSeed) * 0.6 + cos(uTime * 1.4 + aSeed * 1.7) * 0.4;
            // Aumentar seguimiento y cohesión para recuperar "enjambre"
            vec3 steer = dir * (1.6 + 1.2 * h) + ortho * (0.55 * wiggle) + up * (0.5 * sin(uTime * 1.25 + aSeed * 2.2));
            float stick = clamp(uFrenzy * 1.2, 0.0, 1.0);
            pos += steer * (1.15 * (1.0 - 0.5 * stick));

            // Clamp final position to a max radius around the portal center to avoid stray fireflies
            float maxR = uRadius * 1.35;
            vec3 fromC = pos - centerCurr;
            float d = length(fromC);
            if (d > maxR) {
              fromC *= (maxR / d);
              pos = centerCurr + fromC;
            }

            // Evitar quedarse rasantes: empuje hacia arriba si muy bajo respecto al jugador
            float minY = uPlayer.y - 0.4;
            if (pos.y < minY) {
              pos.y = mix(pos.y, minY, 0.6);
            }
            vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
            gl_Position = projectionMatrix * mvPosition;
            float perspectiveSize = aSize * (0.6 + 0.7 * vLife) * (1.0 + 0.1 * uFrenzy);
            gl_PointSize = perspectiveSize * (180.0 / max(1.0, -mvPosition.z)) * uPixelRatio;
          }
        `,fragmentShader:`
          precision highp float;
          uniform vec3 uColor;
          uniform vec3 uTargetColor;
          uniform float uMix;
          varying float vLife;
          varying float vFrenzy;
          void main() {
            // Circular sprite (disc) with sharper falloff for crisp firefly
            vec2 uv = gl_PointCoord * 2.0 - 1.0;
            float d = length(uv);
            if (d > 1.0) discard;
            float core = pow(1.0 - d, 5.0);
            float halo = pow(1.0 - d, 2.0) * 0.2;
            float alpha = clamp(core + halo, 0.0, 1.0);
            // Twinkle/brightness modulation
            float brighten = 0.7 + 0.9 * vLife + 0.6 * vFrenzy;
            vec3 mixCol = mix(uColor, uTargetColor, clamp(uMix, 0.0, 1.0));
            vec3 col = mixCol * brighten;
            gl_FragColor = vec4(col, alpha);
          }
        `})]})}function jt(a){if(!isFinite(a))return"0:00";const n=Math.floor(a/60),r=Math.floor(a%60);return`${n}:${r.toString().padStart(2,"0")}`}function En({tracks:a=[]}){const[n,r]=t.useState(0),[f,u]=t.useState(!1),[m,l]=t.useState(0),[w,M]=t.useState(0),v=t.useRef(null),L=a&&a.length>0,g=L?a[Math.min(n,a.length-1)]:null;t.useEffect(()=>{const s=v.current;if(!s)return;const j=()=>{M(s.duration||0)},O=()=>l(s.currentTime||0),q=()=>{u(!1)},H=()=>{a.length>1?(r(W=>(W+1)%a.length),u(!0)):(u(!1),l(0))},me=()=>{f&&s.play().catch(()=>{})};return s.addEventListener("loadedmetadata",j),s.addEventListener("timeupdate",O),s.addEventListener("error",q),s.addEventListener("ended",H),s.addEventListener("canplay",me),()=>{s.removeEventListener("loadedmetadata",j),s.removeEventListener("timeupdate",O),s.removeEventListener("error",q),s.removeEventListener("ended",H),s.removeEventListener("canplay",me)}},[a,n,f]),t.useEffect(()=>{const s=v.current;if(!s||!g)return;const j=(()=>{try{return encodeURI(new URL(g.src.replace(/^\/+/,""),"/").href)}catch{return g.src}})();if(s.getAttribute("data-src")!==j){s.pause(),s.setAttribute("data-src",j);try{s.src=j}catch{}try{s.load()}catch{}l(0)}f?s.play().catch(()=>{}):s.pause()},[n,f,g]),t.useEffect(()=>{const s=v.current;s&&(f?s.play().catch(()=>{}):s.pause())},[f]);const y=L&&a.length>1,d=y,S=t.useRef(null);return e.jsxs("div",{ref:S,className:"pointer-events-auto w-[360px] max-w-[92vw] rounded-2xl overflow-hidden text-white shadow-xl select-none bg-black/50 backdrop-blur rgb-border rgb-glow",children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-white/5 rounded-b-none",children:[g?.cover?e.jsx("img",{src:g.cover,alt:"cover",className:"absolute inset-0 w-full h-full object-cover rounded-t-2xl"}):e.jsx(Fn,{src:g?.src,className:"absolute inset-0 w-full h-full object-cover rounded-t-2xl"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/80 via-black/40 to-transparent",children:e.jsx("div",{className:"overflow-hidden w-full",children:e.jsx("div",{className:"whitespace-nowrap font-marquee text-base sm:text-lg opacity-95 will-change-transform",style:{animation:"marquee 8s linear infinite"},children:Array.from({length:4}).map((s,j)=>e.jsxs("span",{className:"mx-6",children:[g?.title||"No tracks",g?.artist?` — ${g.artist}`:""]},j))})})})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-5",children:[e.jsx("button",{type:"button",className:"p-2 rounded-full hover:bg-white/10 disabled:opacity-40",onClick:()=>{y&&(r(s=>(s-1+a.length)%a.length),u(!0))},disabled:!y,"aria-label":"Previous",children:e.jsx(zt,{className:"w-7 h-7"})}),e.jsx("button",{type:"button",className:"p-2 rounded-full hover:bg-white/10 disabled:opacity-50",onClick:()=>u(s=>!s),disabled:!L,"aria-label":f?"Pause":"Play",children:f?e.jsx(Ut,{className:"w-9 h-9"}):e.jsx(Wt,{className:"w-9 h-9"})}),e.jsx("button",{type:"button",className:"p-2 rounded-full hover:bg-white/10 disabled:opacity-40",onClick:()=>{d&&(r(s=>(s+1)%a.length),u(!0))},disabled:!d,"aria-label":"Next",children:e.jsx($t,{className:"w-7 h-7"})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("input",{type:"range",min:0,max:Math.max(1,w),step:.01,value:Math.min(m,w||0),onChange:s=>{const j=parseFloat(s.target.value);l(j);const O=v.current;O&&(O.currentTime=j)},className:"w-full accent-white/90"}),e.jsxs("div",{className:"flex justify-between text-[11px] opacity-70 tabular-nums",children:[e.jsx("span",{className:"font-marquee",children:jt(m)}),e.jsx("span",{className:"font-marquee",children:jt(w)})]})]})]}),e.jsx("audio",{ref:v,preload:"metadata"})]})}function Fn({src:a,className:n}){const[r,f]=t.useState(null),u=t.useRef(new Map);return t.useEffect(()=>{let m=!1;if(!a){f(null);return}f(null);const l=a,w=u.current.get(l);if(w){f(w);return}return(async()=>{try{const M=(()=>{try{const y=a.replace(/^\/+/,"");return encodeURI(new URL(y,"/").href)}catch{return encodeURI(a)}})(),v=await fetch(M);if(!v.ok)throw new Error("fetch-failed");const L=await v.blob(),{default:g}=await Ge(async()=>{const{default:y}=await import("./vendor-BWB_NsdB.js").then(d=>d.j);return{default:y}},__vite__mapDeps([0,1,2]));g.read(L,{onSuccess:({tags:y})=>{if(m)return;const d=y.picture;if(d&&d.data&&d.format){const S=new Uint8Array(d.data),s=new Blob([S],{type:d.format}),j=URL.createObjectURL(s);u.current.set(l,j),f(j)}else f(null)},onError:()=>{m||f(null)}})}catch{m||f(null)}})(),()=>{m=!0}},[a]),r?e.jsx("img",{src:r,alt:"cover",className:n||"w-16 h-16 rounded object-cover"}):e.jsx("div",{className:n?`${n} grid place-items-center`:"w-16 h-16 rounded bg-white/10 grid place-items-center text-xs opacity-80",children:"No Cover"})}function Nn({gl:a,sampleMs:n=1e3}){const[r,f]=t.useState({fps:0,calls:0,triangles:0,lines:0,points:0,geometries:0,textures:0}),u=t.useRef(performance.now()),m=t.useRef(0),l=t.useRef(0);return t.useEffect(()=>{const w=()=>{m.current+=1,l.current=requestAnimationFrame(w)};return l.current=requestAnimationFrame(w),()=>cancelAnimationFrame(l.current)},[]),t.useEffect(()=>{let w=null;const M=()=>{const v=performance.now(),L=v-u.current;u.current=v;const g=L>0?Math.round(m.current*1e3/L):0;m.current=0;try{const y=a?.info;f({fps:g,calls:y?.render?.calls||0,triangles:y?.render?.triangles||0,lines:y?.render?.lines||0,points:y?.render?.points||0,geometries:y?.memory?.geometries||0,textures:y?.memory?.textures||0})}catch{}w=setTimeout(M,n)};return w=setTimeout(M,n),()=>{w&&clearTimeout(w)}},[a,n]),e.jsx("div",{style:{position:"fixed",top:8,left:8,zIndex:2e4,pointerEvents:"auto"},children:e.jsxs("div",{style:{background:"rgba(0,0,0,0.6)",color:"white",padding:"6px 8px",borderRadius:6,fontSize:11,lineHeight:1.25,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:[e.jsxs("div",{children:["FPS: ",r.fps]}),e.jsxs("div",{children:["Draws: ",r.calls]}),e.jsxs("div",{children:["Tris: ",r.triangles]}),e.jsxs("div",{children:["Geom: ",r.geometries," · Tex: ",r.textures]})]})})}function Pn({position:a=[0,0,0],radius:n=5,maxDistance:r=80,sampleEvery:f=3,children:u}){const m=t.useRef(),{camera:l}=Je(),w=t.useMemo(()=>new cn,[]),M=t.useMemo(()=>new ln,[]),v=t.useMemo(()=>new un(new T,n),[n]),L=t.useRef({frame:0});return t.useEffect(()=>{m.current&&m.current.position.set(a[0]||0,a[1]||0,a[2]||0)},[a]),Ae(()=>{if(!m.current||!l)return;const g=L.current;if(g.frame=(g.frame+1)%Math.max(1,f),g.frame!==0)return;const y=m.current.getWorldPosition(new T);if(l.position.distanceTo(y)>r){m.current.visible=!1;return}M.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),w.setFromProjectionMatrix(M),v.center.copy(y),v.radius=n,m.current.visible=w.intersectsSphere(v)}),e.jsx("group",{ref:m,children:u})}const An=t.lazy(()=>Ge(()=>import("./Section1-C4DYUQFF.js"),__vite__mapDeps([3,0,1,2]))),In=t.lazy(()=>Ge(()=>import("./Section2-BM9kXko-.js"),__vite__mapDeps([4,0,1,2]))),Ln=t.lazy(()=>Ge(()=>import("./Section3-DyCAKFMm.js"),__vite__mapDeps([5,0,1,2]))),_n=t.lazy(()=>Ge(()=>import("./Section4-B_YpNlz0.js"),__vite__mapDeps([6,0,1,2]))),Ze={home:"#0f172a",section1:"#00bfff",section2:"#00ff26",section3:"#e600ff",section4:"#decf00"};function Dn(){const a=t.useMemo(()=>{if(typeof window>"u"||typeof navigator>"u")return!1;const o=navigator.userAgent||"",p=/Mobi|Android|iPhone|iPad|iPod/i.test(o),c=typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)").matches,i=navigator.connection&&(navigator.connection.saveData||navigator.connection.effectiveType&&/2g/.test(navigator.connection.effectiveType)),h=navigator.deviceMemory&&navigator.deviceMemory<=4,_=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<=4,I=window.devicePixelRatio&&window.devicePixelRatio>2;return!!(p||c||i||h||_||I)},[]),[n,r]=t.useState(()=>({bloom:.78,vignette:.4,noise:0,dotEnabled:!0,dotScale:.76,dotAngle:.06,dotCenterX:.38,dotCenterY:.44,dotOpacity:.05,dotBlend:"screen",godEnabled:!1,godDensity:.35,godDecay:.62,godWeight:.5,godExposure:.22,godClampMax:.56,godSamples:28,dofEnabled:!1,dofProgressive:!1,dofFocusDistance:.375,dofFocalLength:.005,dofBokehScale:2.1,dofFocusSpeed:.12})),[f,u]=t.useState({height:3.35,intensity:8,angle:1.2,penumbra:.6}),[m,l]=t.useState(!1),[w,M]=t.useState(!1),[v,L]=t.useState(!1),[g,y]=t.useState(0),[d,S]=t.useState(!1),[s,j]=t.useState(null),[O,q]=t.useState(!1),H=t.useRef(null),[me,W]=t.useState(!1),[de,ie]=t.useState(!1),[ne,b]=t.useState([]),[R,G]=t.useState(!1),[K,B]=t.useState(!1),[$,X]=t.useState(!1),ce=t.useRef(null),[pe,Xe]=t.useState(null);t.useRef(null);const[A,Z]=t.useState("home"),[F,oe]=t.useState({active:!1,from:"home",to:null}),he=ze.useCallback(()=>{if(!F.active&&A!=="home"){G(!1),B(!1),j("home"),oe({active:!0,from:A,to:"home"}),Z("home");try{typeof window<"u"&&window.location.pathname!=="/"&&window.history.pushState({section:"home"},"","/")}catch{}}},[A,F.active]),[ae,ge]=t.useState(!1),ve=t.useRef(null),[J,Ue]=t.useState(null),[We,Ie]=t.useState(!1),ye=t.useRef(null),[ke,je]=t.useState(!1),[be,Le]=t.useState(!1),Te=t.useRef(null),[$e,_e]=t.useState(!1),[Ye,Ee]=t.useState(!1),Ce=t.useRef(null),[Ve,Qe]=t.useState(null),et=t.useMemo(()=>({home:"HOME",section1:"WORK",section2:"ABOUT",section3:"SIDE QUESTS",section4:"CONTACT"}),[]),tt="/",dt=t.useMemo(()=>({section1:"work",section2:"about",section3:"side-quests",section4:"contact"}),[]),it=t.useMemo(()=>({work:"section1",about:"section2","side-quests":"section3",contact:"section4"}),[]),ft=o=>o&&o!=="home"?`${tt}${dt[o]||o}`:tt,x=o=>{try{const p=new URL(tt,window.location.origin);let i=new URL(o,window.location.origin).pathname;const h=p.pathname.endsWith("/")?p.pathname:`${p.pathname}/`;return i.startsWith(h)&&(i=i.slice(h.length)),i=i.replace(/^\//,""),i===""||i==="/"?"home":it[i]?it[i]:["section1","section2","section3","section4"].includes(i)?i:"home"}catch{return"home"}};ze.useEffect(()=>{if(typeof window>"u")return;const o=x(window.location.pathname);o&&Z(o)},[]),ze.useEffect(()=>{if(typeof window>"u")return;const o=()=>{try{Ge(()=>import("./Section1-C4DYUQFF.js"),__vite__mapDeps([3,0,1,2]))}catch{}try{Ge(()=>import("./Section2-BM9kXko-.js"),__vite__mapDeps([4,0,1,2]))}catch{}try{Ge(()=>import("./Section3-DyCAKFMm.js"),__vite__mapDeps([5,0,1,2]))}catch{}try{Ge(()=>import("./Section4-B_YpNlz0.js"),__vite__mapDeps([6,0,1,2]))}catch{}};"requestIdleCallback"in window?window.requestIdleCallback(o,{timeout:2e3}):setTimeout(o,0)},[]),ze.useEffect(()=>{let o=!1;return(async()=>{try{const c=await(await fetch("/songs/manifest.json",{cache:"no-cache"})).json();o||b(Array.isArray(c)?c:[])}catch{o||b([])}})(),()=>{o=!0}},[]),t.useEffect(()=>{if(!F.active){if(A!=="home")G(!0),B(!1),X(!1),requestAnimationFrame(()=>{try{ce.current&&(ce.current.scrollTop=0)}catch{}setTimeout(()=>X(!0),10)});else if(R){B(!0),X(!1);const o=setTimeout(()=>{G(!1),B(!1)},300);return()=>clearTimeout(o)}}},[A,F.active,R]),t.useEffect(()=>{const o=R||K,p=document.body.style.overflow;return o&&(document.body.style.overflow="hidden"),()=>{document.body.style.overflow=p}},[R,K]),t.useEffect(()=>{const o=p=>{p.key==="Escape"&&R&&!F.active&&he()};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[R,F.active,he]);const E=o=>{if(typeof window>"u")return;const p=ft(o);window.location.pathname!==p&&window.history.pushState({section:o},"",p)};ze.useEffect(()=>{if(typeof window>"u")return;const o=()=>{const p=x(window.location.pathname);if(p){if(p==="home"){G(!1),B(!1),!F.active&&A!=="home"&&oe({active:!0,from:A,to:"home"}),Z("home");return}p!==A&&!F.active&&oe({active:!0,from:A,to:p})}};return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[A,F.active]);const k=t.useRef(),N=t.useRef(),re=k,we=t.useRef(new T(0,0,0)),Q=t.useRef(null),Fe=t.useMemo(()=>[{id:"section1",position:[0,0,-16],color:Ze.section1},{id:"section2",position:[16,0,0],color:Ze.section2},{id:"section3",position:[-16,0,0],color:Ze.section3},{id:"section4",position:[0,0,16],color:Ze.section4}],[]),Me=o=>{!F.active&&o!==A&&oe({active:!0,from:A,to:o})},nt=()=>{if(Z(F.to),oe({active:!1,from:F.to||A,to:null}),F.to&&E(F.to),F.to==="home"){try{k.current&&(k.current.position.set(0,0,0),k.current.rotation.set(0,0,0))}catch{}G(!1),B(!1),Xe(null),Ue(null),je(!1),_e(!1),xe(0);try{ve.current&&(ve.current.enabled=!0)}catch{}}ye.current&&(clearTimeout(ye.current),ye.current=null),Ie(!0),ye.current=setTimeout(()=>{Ie(!1),ye.current=null},1800)};ze.useEffect(()=>{if(F.active)return;J||pe?(je(!0),Le(!1),Te.current&&(clearTimeout(Te.current),Te.current=null)):ke&&(Le(!0),Te.current&&clearTimeout(Te.current),Te.current=window.setTimeout(()=>{je(!1),Le(!1),Te.current=null},220))},[J,pe,F.active,ke]),ze.useEffect(()=>{if(F.active)return;!!(J||pe||We)?(_e(!0),Ee(!1),Qe(J||pe||A),Ce.current&&(clearTimeout(Ce.current),Ce.current=null)):$e&&(Ee(!0),Ce.current&&clearTimeout(Ce.current),Ce.current=window.setTimeout(()=>{_e(!1),Ee(!1),Ce.current=null},200))},[J,pe,We,F.active,$e,A]),t.useEffect(()=>{F.active&&F.from!=="home"&&F.to},[F]);const[le,xe]=t.useState(0),ue=t.useMemo(()=>Ne("#204580","#0a132b",le),[le]),[He,De]=t.useState({});function Ne(o,p,c){const i=parseInt(o.slice(1),16),h=parseInt(p.slice(1),16),_=Math.round((i>>16&255)*(1-c)+(h>>16&255)*c),I=Math.round((i>>8&255)*(1-c)+(h>>8&255)*c),V=Math.round((i&255)*(1-c)+(h&255)*c);return`#${((1<<24)+(_<<16)+(I<<8)+V).toString(16).slice(1)}`}const C=ae?"#7a0b0b":ue;return e.jsxs("div",{className:"w-full h-full relative overflow-hidden",children:[e.jsx(Et,{shadows:{type:dn},dpr:[1,a?1.2:1.5],gl:{antialias:!1,powerPreference:"high-performance",alpha:!1,stencil:!1,preserveDrawingBuffer:!1},camera:{position:[0,3,8],fov:60,near:.1,far:120},onCreated:({gl:o})=>{try{o.getContextAttributes()}catch{}H.current=o},children:e.jsxs(t.Suspense,{fallback:null,children:[e.jsx(fn,{pixelated:!0}),e.jsx(hn,{paused:(R||K)&&!F.active}),e.jsx(pn,{overrideColor:C,lowPerf:a}),n.godEnabled&&e.jsxs("mesh",{ref:N,position:[0,8,0],children:[e.jsx("sphereGeometry",{args:[.35,12,12]}),e.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:0,depthWrite:!1})]}),e.jsx(xn,{playerRef:k,portals:Fe,onPortalEnter:Me,onProximityChange:o=>{const p=(c,i,h=.22)=>c+(i-c)*h;xe(c=>p(c??0,o))},onPortalsProximityChange:De,onNearPortalChange:o=>Ue(o),navigateToPortalId:s,sceneColor:C,onReachedPortal:o=>{try{Q.current=o}catch{}j(null)},onOrbStateChange:o=>q(o)}),e.jsx(kn,{playerRef:k,height:f.height,intensity:f.intensity,angle:f.angle,penumbra:f.penumbra,color:"#fff"}),Fe.map(o=>{const p=He[o.id]||0,c=Ze[o.id]||"#ffffff";return e.jsxs(Pn,{position:o.position,radius:4.5,maxDistance:64,sampleEvery:4,children:[e.jsx(yn,{position:[0,0,0],color:o.color,targetColor:c,mix:p,size:2}),e.jsx(Tn,{center:[0,0,0],radius:4,count:a?120:220,color:"#9ec6ff",targetColor:c,mix:p,playerRef:k,frenzyRadius:10})]},o.id)}),e.jsx(wn,{playerRef:k,controlsRefExternal:ve,shakeActive:ae||!!J,shakeAmplitude:ae?.18:.08,shakeFrequencyX:ae?22:14,shakeFrequencyY:ae?18:12,shakeYMultiplier:ae?1:.9,enabled:!R&&!K}),e.jsx(Rn,{lowPerf:!1,eggActiveGlobal:ae,bloom:n.bloom,vignette:n.vignette,noise:n.noise,dotEnabled:n.dotEnabled,dotScale:n.dotScale,dotAngle:n.dotAngle,dotCenterX:n.dotCenterX,dotCenterY:n.dotCenterY,dotOpacity:n.dotOpacity,dotBlend:n.dotBlend,godEnabled:n.godEnabled,godSun:N,godDensity:n.godDensity,godDecay:n.godDecay,godWeight:n.godWeight,godExposure:n.godExposure,godClampMax:n.godClampMax,godSamples:n.godSamples,dofEnabled:n.dofEnabled,dofProgressive:n.dofProgressive,dofFocusDistance:n.dofFocusDistance,dofFocalLength:n.dofFocalLength,dofBokehScale:n.dofBokehScale,dofFocusSpeed:n.dofFocusSpeed,dofTargetRef:re}),e.jsx(bn,{active:F.active,fromColor:Ze[F.from],toColor:Ze[F.to||A],duration:.8,onComplete:nt,forceOnceKey:`${F.from}->${F.to}`})]})}),de&&e.jsx(Nn,{sampleMs:1e3,gl:H.current}),(R||K)&&e.jsxs("div",{ref:ce,className:"fixed inset-0 z-[12000] pointer-events-auto overflow-y-auto",style:{backgroundColor:Ze[A]||"#000000",opacity:$&&R&&!K?1:0,transition:"opacity 500ms ease"},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundColor:"#000000",opacity:K?1:0,transition:"opacity 300ms ease"}}),e.jsxs("div",{className:"min-h-screen w-full",children:[e.jsx("div",{className:"sticky top-0 z-[10] flex items-center justify-end px-4 py-3 bg-black/20 backdrop-blur-sm",children:e.jsx("button",{type:"button",onClick:he,className:"px-3 py-1.5 rounded-full bg-white/90 hover:bg-white text-black text-sm font-semibold shadow","aria-label":"Cerrar sección",children:"Cerrar"})}),e.jsx(t.Suspense,{fallback:null,children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 sm:p-8",children:[A==="section1"&&e.jsx(An,{}),A==="section2"&&e.jsx(In,{}),A==="section3"&&e.jsx(Ln,{}),A==="section4"&&e.jsx(_n,{})]})})]})]}),!F.active&&(ke||be)&&e.jsx("div",{className:"pointer-events-auto fixed inset-x-0 bottom-24 z-[10000] flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:()=>{const o=J||pe;if(o&&!F.active&&o!==A){try{k.current&&we.current.copy(k.current.position)}catch{}try{Q.current=o}catch{}if(oe({active:!0,from:A,to:o}),y(p=>p+1),Z(o),typeof window<"u"){const i=o&&o!=="home"?`/${{section1:"work",section2:"about",section3:"side-quests",section4:"contact"}[o]||o}`:"/";window.location.pathname!==i&&window.history.pushState({section:o},"",i)}Ue(null),window.setTimeout(()=>{oe(p=>p.active?{active:!1,from:o,to:null}:p)},900)}},className:"px-6 sm:px-8 md:px-12 py-3 sm:py-3.5 md:py-4 rounded-full bg-white text-black font-bold uppercase tracking-wide text-lg sm:text-2xl md:text-3xl shadow-[0_8px_24px_rgba(0,0,0,0.35)] hover:translate-y-[-2px] active:translate-y-[0] transition-transform font-marquee",style:{fontFamily:"'Luckiest Guy', Archivo Black, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif",animation:`${J||pe?"slideup 220ms ease-out forwards":"slideup-out 220ms ease-in forwards"}`},children:"Cruza el portal"})}),!F.active&&($e||Ye)&&e.jsxs("div",{className:"fixed top-0 left-0 right-0 z-[9999] pointer-events-none py-2",style:{animation:`${J||We?"slidedown 200ms ease-out":"slidedown-out 200ms ease-in forwards"}`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/55 to-transparent"}),e.jsx("div",{className:"overflow-hidden w-full",children:e.jsx("div",{className:"whitespace-nowrap opacity-95 will-change-transform",style:{animation:"marquee 18s linear infinite"},children:Array.from({length:6}).map((o,p)=>e.jsxs("span",{className:"title-banner",style:{fontFamily:"'Luckiest Guy', Archivo Black, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif",WebkitTextStroke:"1px rgba(255,255,255,0.08)",textShadow:"0 2px 10px rgba(0,0,0,0.9)"},children:[et[Ve||J||pe||A]||(Ve||J||pe||A||"").toUpperCase(),p<5?" · ":""]},p))})})]}),e.jsx("button",{type:"button",onClick:()=>l(o=>!o),className:"pointer-events-auto fixed right-4 bottom-4 h-9 w-9 rounded-full bg-black/60 hover:bg-black/70 text-white text-xs grid place-items-center shadow-md z-[15000]","aria-label":"Toggle panel FX",children:"FX"}),e.jsx("button",{type:"button",onClick:()=>W(o=>!o),className:"pointer-events-auto fixed right-4 bottom-16 h-9 w-9 rounded-full bg-black/60 hover:bg-black/70 text-white grid place-items-center shadow-md z-[400]","aria-label":"Toggle music player",children:e.jsx(Yt,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:()=>ie(o=>!o),className:"pointer-events-auto fixed right-4 bottom-40 h-9 w-9 rounded-full bg-black/60 hover:bg-black/70 text-white text-[10px] grid place-items-center shadow-md z-[15000]","aria-label":"Toggle GPU stats",children:"GPU"}),e.jsx("div",{className:"pointer-events-auto fixed inset-x-0 bottom-4 z-[450] flex items-center justify-center gap-3",children:["section1","section2","section3","section4"].map(o=>e.jsx("button",{type:"button",onClick:()=>{O||(j(o),y(p=>p+1))},className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-full bg-white/10 hover:bg-white/20 text-white text-sm sm:text-base font-marquee uppercase tracking-wide shadow-[0_2px_10px_rgba(0,0,0,0.25)]",children:et[o]},o))}),e.jsx("div",{className:`fixed right-4 bottom-20 z-[500] transition-all duration-200 ${me?"opacity-100 translate-y-0 pointer-events-auto":"opacity-0 translate-y-2 pointer-events-none"}`,"aria-hidden":!me,children:e.jsx(En,{tracks:ne})}),m&&e.jsxs("div",{className:"pointer-events-auto fixed right-4 bottom-16 w-56 p-3 rounded-md bg-black/50 text-white space-y-2 select-none z-[500]",children:[e.jsx("div",{className:"text-xs font-semibold opacity-80",children:"Post‑Processing"}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] opacity-80",children:[e.jsx("span",{children:"GodRays"}),e.jsx("input",{type:"checkbox",checked:n.godEnabled,onChange:o=>{const p=o.target.checked,c=n.godDensity===.9&&n.godDecay===.95&&n.godWeight===.6&&n.godExposure===.3&&n.godClampMax===1&&n.godSamples===60;r({...n,godEnabled:p,...p&&c?{godDensity:1.1,godDecay:.94,godWeight:1,godExposure:.6,godClampMax:1.2,godSamples:80}:{}})}})]}),n.godEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Density: ",n.godDensity.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.1",max:"1.5",step:"0.01",value:n.godDensity,onChange:o=>r({...n,godDensity:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Decay: ",n.godDecay.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.5",max:"1.0",step:"0.01",value:n.godDecay,onChange:o=>r({...n,godDecay:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Weight: ",n.godWeight.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.1",max:"1.5",step:"0.01",value:n.godWeight,onChange:o=>r({...n,godWeight:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Exposure: ",n.godExposure.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.0",max:"1.0",step:"0.01",value:n.godExposure,onChange:o=>r({...n,godExposure:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["ClampMax: ",n.godClampMax.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.2",max:"2.0",step:"0.01",value:n.godClampMax,onChange:o=>r({...n,godClampMax:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Samples: ",n.godSamples,e.jsx("input",{className:"w-full",type:"range",min:"16",max:"120",step:"1",value:n.godSamples,onChange:o=>r({...n,godSamples:parseInt(o.target.value,10)})})]})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Bloom: ",n.bloom.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1.5",step:"0.01",value:n.bloom,onChange:o=>r({...n,bloom:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Vignette: ",n.vignette.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:n.vignette,onChange:o=>r({...n,vignette:parseFloat(o.target.value)})})]}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] opacity-80",children:[e.jsx("span",{children:"Halftone (DotScreen)"}),e.jsx("input",{type:"checkbox",checked:n.dotEnabled,onChange:o=>r({...n,dotEnabled:o.target.checked})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Dot scale: ",n.dotScale.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"3",step:"0.01",value:n.dotScale,onChange:o=>r({...n,dotScale:parseFloat(o.target.value)}),disabled:!n.dotEnabled})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Dot angle: ",n.dotAngle.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"3.1416",step:"0.01",value:n.dotAngle,onChange:o=>r({...n,dotAngle:parseFloat(o.target.value)}),disabled:!n.dotEnabled})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"flex-1 block text-[11px] opacity-80",children:["Center X: ",n.dotCenterX.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:n.dotCenterX,onChange:o=>r({...n,dotCenterX:parseFloat(o.target.value)}),disabled:!n.dotEnabled})]}),e.jsxs("label",{className:"flex-1 block text-[11px] opacity-80",children:["Center Y: ",n.dotCenterY.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:n.dotCenterY,onChange:o=>r({...n,dotCenterY:parseFloat(o.target.value)}),disabled:!n.dotEnabled})]})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Dot opacity: ",n.dotOpacity.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:n.dotOpacity,onChange:o=>r({...n,dotOpacity:parseFloat(o.target.value)}),disabled:!n.dotEnabled})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Dot blend",e.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded mt-1",value:n.dotBlend,onChange:o=>r({...n,dotBlend:o.target.value}),disabled:!n.dotEnabled,children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"multiply",children:"Multiply"}),e.jsx("option",{value:"screen",children:"Screen"}),e.jsx("option",{value:"overlay",children:"Overlay"}),e.jsx("option",{value:"softlight",children:"SoftLight"}),e.jsx("option",{value:"add",children:"Add"}),e.jsx("option",{value:"darken",children:"Darken"}),e.jsx("option",{value:"lighten",children:"Lighten"})]})]}),e.jsx("button",{type:"button",className:"mt-1 w-full py-1.5 text-[12px] rounded bg-white/10 hover:bg-white/20 transition-colors",onClick:async()=>{const o=JSON.stringify(n,null,2);try{await navigator.clipboard.writeText(o)}catch{const p=document.createElement("textarea");p.value=o,document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p)}S(!0),setTimeout(()=>S(!1),1200)},children:d?"¡Copiado!":"Copiar preset FX"}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Noise: ",n.noise.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"0.6",step:"0.01",value:n.noise,onChange:o=>r({...n,noise:parseFloat(o.target.value)})})]}),e.jsx("div",{className:"h-px bg-white/10 my-2"}),e.jsx("div",{className:"text-xs font-semibold opacity-80",children:"Depth of Field"}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] opacity-80",children:[e.jsx("span",{children:"Activar"}),e.jsx("input",{type:"checkbox",checked:n.dofEnabled,onChange:o=>r({...n,dofEnabled:o.target.checked})})]}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] opacity-80",children:[e.jsx("span",{children:"Progresivo"}),e.jsx("input",{type:"checkbox",checked:n.dofProgressive,onChange:o=>r({...n,dofProgressive:o.target.checked})})]}),!n.dofProgressive&&e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Focus distance: ",n.dofFocusDistance.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.005",value:n.dofFocusDistance,onChange:o=>r({...n,dofFocusDistance:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Focal length: ",n.dofFocalLength.toFixed(3),e.jsx("input",{className:"w-full",type:"range",min:"0.001",max:"0.06",step:"0.001",value:n.dofFocalLength,onChange:o=>r({...n,dofFocalLength:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Bokeh scale: ",n.dofBokehScale.toFixed(1),e.jsx("input",{className:"w-full",type:"range",min:"0.5",max:"6",step:"0.1",value:n.dofBokehScale,onChange:o=>r({...n,dofBokehScale:parseFloat(o.target.value)})})]}),n.dofProgressive&&e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Focus speed: ",n.dofFocusSpeed.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.02",max:"0.5",step:"0.01",value:n.dofFocusSpeed,onChange:o=>r({...n,dofFocusSpeed:parseFloat(o.target.value)})})]})]}),e.jsx("button",{type:"button",onClick:()=>M(o=>!o),className:"pointer-events-auto fixed right-4 top-4 h-9 w-9 rounded-full bg-black/60 hover:bg-black/70 text-white text-xs grid place-items-center shadow-md","aria-label":"Toggle panel Luz",children:"Luz"}),w&&e.jsxs("div",{className:"pointer-events-auto fixed right-4 top-16 w-56 p-3 rounded-md bg-black/50 text-white space-y-2 select-none",children:[e.jsx("button",{type:"button",className:"mt-1 w-full py-1.5 text-[12px] rounded bg-white/10 hover:bg-white/20 transition-colors",onClick:async()=>{const o=JSON.stringify(f,null,2);try{await navigator.clipboard.writeText(o)}catch{const p=document.createElement("textarea");p.value=o,document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p)}},children:"Copiar preset Luz"}),e.jsx("div",{className:"text-xs font-semibold opacity-80",children:"Luz superior"}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Altura: ",f.height.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"2",max:"12",step:"0.05",value:f.height,onChange:o=>u({...f,height:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Intensidad: ",f.intensity.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"8",step:"0.05",value:f.intensity,onChange:o=>u({...f,intensity:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Ángulo: ",f.angle.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0.1",max:"1.2",step:"0.01",value:f.angle,onChange:o=>u({...f,angle:parseFloat(o.target.value)})})]}),e.jsxs("label",{className:"block text-[11px] opacity-80",children:["Penumbra: ",f.penumbra.toFixed(2),e.jsx("input",{className:"w-full",type:"range",min:"0",max:"1",step:"0.01",value:f.penumbra,onChange:o=>u({...f,penumbra:parseFloat(o.target.value)})})]})]}),e.jsx(Cn,{showUI:v,dotEnabled:n.dotEnabled,dotScale:n.dotScale,dotAngle:n.dotAngle,dotCenterX:n.dotCenterX,dotCenterY:n.dotCenterY,dotOpacity:n.dotOpacity,dotBlend:n.dotBlend,glowVersion:g,onEggActiveChange:ge}),e.jsx("button",{type:"button",onClick:()=>L(o=>!o),className:"pointer-events-auto fixed left-40 bottom-4 h-9 w-9 rounded-full bg-black/60 hover:bg-black/70 text-white text-[10px] grid place-items-center shadow-md","aria-label":"Toggle panel Retrato",children:"Ret"})]})}qt.createRoot(document.getElementById("root")).render(e.jsx(ze.StrictMode,{children:e.jsx(Dn,{})}));
